# Validation script for "IngressNightmare" (CVE-2025-1974)

This Python script can help you understand if you're running the Ingress NGINX Controller, and if yes if it's using a known vulnerable version.

## Usage

First, make sure you're authenticated against the Kubernetes cluster to audit. Then, run:

```
python3 -m venv venv && source venv/bin/activate
python check.py
```

## Sample outputs

Vulnerable cluster:

```
Checking for ingress-nginx pods...
â„¹ï¸ It looks like you're using the NGinx ingress controller.

Checking service 'ingress-nginx-controller-admission' in namespace 'ingress-nginx'...
â„¹ï¸ Found related service 'ingress-nginx-controller-admission' of type: ClusterIP
  â†’ ClusterIP: 10.100.127.164

ğŸ“¦ Images used by ingress-nginx controller pods:
  - registry.k8s.io/ingress-nginx/controller:v1.12.0@sha256:e6b8de175acda6ca913891f0f727bca4527e797d52688cbe9fec9040d6f6b6fa

ğŸ”¢ Detected ingress-nginx controller versions:
  â†’ 1.12.0   ğŸ›‘ LIKELY VULNERABLE
```

Cluster running a non-vulnerable version:

```
Checking for ingress-nginx pods...
â„¹ï¸ It looks like you're using the NGinx ingress controller.

Checking service 'ingress-nginx-controller-admission' in namespace 'ingress-nginx'...
â„¹ï¸ Found related service 'ingress-nginx-controller-admission' of type: ClusterIP
  â†’ ClusterIP: 10.96.74.187

ğŸ“¦ Images used by ingress-nginx controller pods:
  - registry.k8s.io/ingress-nginx/controller:v1.12.1@sha256:d2fbc4ec70d8aa2050dd91a91506e998765e86c96f32cffb56c503c9c34eed5b

ğŸ”¢ Detected ingress-nginx controller versions:
  â†’ 1.12.1   âœ… Likely safe
```

Cluster not running the Ingress NGINX Controller:

```
Checking for ingress-nginx pods...
âœ… No NGinx ingress controller pods found.

Checking service 'ingress-nginx-controller-admission' in namespace 'ingress-nginx'...
âœ…  Service 'ingress-nginx-controller-admission' not found in namespace 'ingress-nginx'.
```